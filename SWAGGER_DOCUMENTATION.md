# 📚 MG-ERP Swagger/OpenAPI Documentation Guide

## Overview
Your MG-ERP application comes with **professional-grade API documentation** built into FastAPI! This document explains the comprehensive Swagger UI implementation and how to use it effectively.

## 🔍 Available Documentation Endpoints

### **Interactive Documentation**
- **Swagger UI**: `http://127.0.0.1:8000/docs` - Primary interactive documentation
- **ReDoc**: `http://127.0.0.1:8000/redoc` - Alternative clean documentation view
- **OpenAPI Schema**: `http://127.0.0.1:8000/openapi.json` - Raw OpenAPI 3.0 specification

## 🎯 What We Implemented

### **1. Enhanced Application Metadata**
```python
app = FastAPI(
    title="MG-ERP Ledger API",
    description="""
    ## 📊 Comprehensive Ledger Management System
    
    A professional-grade ERP system for managing accounts and financial transactions 
    with enterprise-level security.
    
    ### 🔐 Authentication Required
    Most endpoints require authentication. Use the login endpoint to obtain a JWT token.
    
    ### 🏛️ Key Features
    * Account Management - Create, view, update, and manage chart of accounts
    * Transaction Processing - Record and track financial transactions
    * User Management - Role-based access control with granular permissions
    * JWT Authentication - Secure token-based authentication system
    * Role-Based Authorization - Admin, Manager, Accountant, and Viewer roles
    
    ### 🚀 Quick Start
    1. Login: Use `/api/v1/auth/login` with default admin credentials (admin/admin123)
    2. Get Token: Copy the access_token from the response
    3. Authorize: Click the 🔒 Authorize button and paste your token
    4. Explore: Try the account and transaction endpoints
    """,
    version="1.0.0",
    contact={
        "name": "MG-ERP Development Team",
        "url": "https://mgledger.com/contact",
        "email": "support@mgledger.com",
    },
    license_info={
        "name": "MIT License",
        "url": "https://opensource.org/licenses/MIT",
    }
)
```

### **2. Organized API Tags**
We created logical groupings for better navigation:

```python
openapi_tags=[
    {
        "name": "Authentication",
        "description": "User authentication and authorization endpoints. **Start here** to get your access token.",
    },
    {
        "name": "accounts", 
        "description": "Chart of accounts management. Create and manage your account structure for double-entry bookkeeping."
    },
    {
        "name": "transactions",
        "description": "Financial transaction recording. Post journal entries with automatic balance validation."
    },
    {
        "name": "health",
        "description": "System health and status monitoring endpoints."
    }
]
```

### **3. Enhanced Endpoint Documentation**

#### **Authentication Endpoints**
```python
@router.post("/login", 
            response_model=TokenResponse, 
            summary="🔐 User Login", 
            description="""
            Authenticate user and receive JWT access token.
            
            **Default admin credentials:**
            - Username: `admin`
            - Password: `admin123`
            
            The returned access token should be used in the Authorization header:
            `Authorization: Bearer <access_token>`
            """)
```

#### **Account Management Endpoints**
```python
@router.get("/", 
           response_model=List[AccountSchema], 
           summary="📋 List All Accounts",
           description="""
           Retrieve all accounts in the chart of accounts.
           
           **Permission Required:** `account:read`
           
           Returns the complete chart of accounts including:
           - Account codes and names
           - Account types (asset, liability, equity, revenue, expense)
           - Current balances
           - Active status
           """)
```

#### **Transaction Processing Endpoints**
```python
@router.post("/", 
            response_model=TransactionSchema,
            summary="💰 Create New Transaction",
            description="""
            Record a new financial transaction with journal entries.
            
            **Permission Required:** `transaction:create`
            
            **Double-Entry Bookkeeping Rules:**
            - Total debits must equal total credits
            - Each transaction must have at least 2 journal lines
            - Account names must exist in the chart of accounts
            
            **Transaction Sources:**
            - `manual` - Manually entered transactions
            - `import` - Imported from external systems
            - `system` - Auto-generated by system processes
            """)
```

### **4. Rich Schema Examples**

#### **Account Creation Example**
```json
{
  "name": "Cash in Bank",
  "type": "asset",
  "code": "1001",
  "description": "Main checking account for operations",
  "is_active": true
}
```

#### **User Registration Example**
```json
{
  "username": "john_doe",
  "email": "john@company.com",
  "full_name": "John Doe",
  "password": "secure_password123",
  "role": "accountant"
}
```

#### **Transaction Example**
```json
{
  "description": "Office rent payment for January 2025",
  "source": "manual",
  "reference": "CHK-001234",
  "lines": [
    {
      "account_name": "Rent Expense",
      "type": "debit",
      "amount": 2000.00
    },
    {
      "account_name": "Cash in Bank",
      "type": "credit",
      "amount": 2000.00
    }
  ]
}
```

### **5. Comprehensive Health Check**
```python
@app.get("/health", 
         summary="🔍 Detailed Health Check",
         description="Comprehensive health check with system information and available endpoints.")
def detailed_health_check():
    return {
        "status": "healthy",
        "service": "MG-ERP Ledger API",
        "version": "1.0.0",
        "database": "PostgreSQL",
        "authentication": "JWT Bearer Token",
        "documentation": {
            "swagger_ui": "/docs",
            "redoc": "/redoc",
            "openapi_schema": "/openapi.json"
        },
        "endpoints": {
            "authentication": "/api/v1/auth",
            "accounts": "/api/v1/accounts",
            "transactions": "/api/v1/transactions"
        },
        "default_credentials": {
            "username": "admin",
            "password": "admin123",
            "note": "⚠️ Change in production!"
        }
    }
```

## 🚀 How to Use the Swagger UI

### **Step 1: Start the Server**
```bash
uvicorn app.main:app --reload --host 127.0.0.1 --port 8000
```

### **Step 2: Open Swagger UI**
Navigate to: `http://127.0.0.1:8000/docs`

### **Step 3: Authenticate**
1. **Login**: Click on `/api/v1/auth/login` endpoint
2. **Try it out**: Click the "Try it out" button
3. **Enter credentials**:
   ```json
   {
     "username": "admin",
     "password": "admin123"
   }
   ```
4. **Execute**: Click "Execute" to get your JWT token
5. **Copy token**: Copy the `access_token` from the response

### **Step 4: Authorize**
1. **Click 🔒 Authorize** button at the top of the page
2. **Enter token**: Paste your JWT token in the "Value" field
3. **Authorize**: Click "Authorize" button
4. **Close**: Close the authorization dialog

### **Step 5: Test Endpoints**
Now you can test all protected endpoints:
- ✅ **GET /api/v1/accounts** - List all accounts
- ✅ **POST /api/v1/accounts** - Create new accounts
- ✅ **GET /api/v1/transactions** - View transactions
- ✅ **POST /api/v1/transactions** - Record new transactions

## 🎨 Advanced Features Available

### **Built-in FastAPI Features**
- ✅ **Interactive Testing** - Execute requests directly from docs
- ✅ **Request/Response Validation** - Live schema validation  
- ✅ **Code Generation** - Client SDK generation for multiple languages
- ✅ **Export Options** - Download OpenAPI spec as JSON/YAML
- ✅ **Multiple Themes** - Swagger UI and ReDoc interfaces
- ✅ **Mobile Responsive** - Works on all devices

### **Authentication Integration**
- ✅ **JWT Token Support** - Built-in authorization testing
- ✅ **Permission Documentation** - Required permissions clearly stated
- ✅ **Role Information** - Role-based access control explained
- ✅ **Security Schemes** - OAuth2 Bearer token authentication

### **Business Logic Documentation**
- ✅ **Double-Entry Rules** - Accounting principles explained
- ✅ **Validation Requirements** - Business rules documented
- ✅ **Error Responses** - HTTP status codes and error messages
- ✅ **Permission Matrix** - Role-based access clearly defined

## 🔧 Optional Enhancements

### **Additional Features You Can Add**

#### **1. API Versioning**
```python
app_v1 = FastAPI(title="MG-ERP API v1")
app_v2 = FastAPI(title="MG-ERP API v2")
```

#### **2. Custom Themes**
```python
app = FastAPI(
    swagger_ui_parameters={
        "theme": "flattop",
        "displayRequestDuration": True,
        "docExpansion": "none",
    }
)
```

#### **3. Request Examples**
```python
@router.post("/accounts", 
            responses={
                201: {"description": "Account created successfully"},
                400: {"description": "Invalid account data"},
                403: {"description": "Insufficient permissions"},
                409: {"description": "Account code already exists"}
            })
```

#### **4. Postman Collection Export**
The OpenAPI schema can be imported directly into Postman for collection generation.

## 📊 Documentation Structure

```
MG-ERP API Documentation
├── 🔐 Authentication
│   ├── POST /auth/login (User Login)
│   ├── GET /auth/me (Current User Profile)
│   ├── POST /auth/register (Create User - Admin)
│   ├── POST /auth/change-password (Change Password)
│   └── GET /auth/users (List Users - Admin)
│
├── 📋 Accounts  
│   ├── GET /accounts (List All Accounts)
│   └── POST /accounts (Create New Account)
│
├── 💰 Transactions
│   ├── GET /transactions (List All Transactions) 
│   ├── POST /transactions (Create New Transaction)
│   └── GET /transactions/{id} (Get Transaction by ID)
│
└── 🏥 Health
    ├── GET / (Basic Health Check)
    └── GET /health (Detailed Health Check)
```

## 🎯 Business Benefits

### **For Developers**
- ✅ **Faster Integration** - Clear API documentation
- ✅ **Interactive Testing** - No need for separate testing tools
- ✅ **Code Examples** - Copy-paste ready request examples
- ✅ **Type Safety** - Complete schema definitions

### **For Business Users**
- ✅ **API Understanding** - Non-technical stakeholders can explore APIs
- ✅ **Feature Discovery** - Complete feature overview
- ✅ **Integration Planning** - Clear endpoint capabilities
- ✅ **Security Transparency** - Permission requirements visible

### **For System Integration**
- ✅ **Client Generation** - Auto-generate SDKs for multiple languages
- ✅ **API Contract** - OpenAPI spec serves as integration contract  
- ✅ **Testing Automation** - Schema validation for automated tests
- ✅ **Documentation Sync** - Always up-to-date with code changes

## 🔒 Security Documentation

### **Authentication Flow**
1. **Login** → JWT Token
2. **Authorization Header** → `Bearer <token>`
3. **Permission Check** → Role-based validation
4. **Access Control** → Granular permissions

### **Role Permissions Matrix**

| Endpoint | Admin | Manager | Accountant | Viewer |
|----------|-------|---------|------------|--------|
| Login | ✅ | ✅ | ✅ | ✅ |
| List Accounts | ✅ | ✅ | ✅ | ✅ |
| Create Accounts | ✅ | ✅ | ✅ | ❌ |
| List Transactions | ✅ | ✅ | ✅ | ✅ |
| Create Transactions | ✅ | ✅ | ✅ | ❌ |
| User Management | ✅ | ❌ | ❌ | ❌ |

## 🎉 Conclusion

Your MG-ERP system now has **enterprise-grade API documentation** that:

- ✅ **Rivals major SaaS platforms** in documentation quality
- ✅ **Provides interactive testing** capabilities
- ✅ **Explains business logic** clearly
- ✅ **Documents security requirements** transparently  
- ✅ **Includes practical examples** for all endpoints
- ✅ **Supports multiple export formats**
- ✅ **Works on all devices** with responsive design

**The enhanced Swagger UI makes your MG-ERP system professional, accessible, and developer-friendly!** 🚀

---

*Generated automatically by FastAPI with custom enhancements for MG-ERP system.*
*Last updated: September 28, 2025*