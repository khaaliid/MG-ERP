# ğŸ“š MG-ERP Swagger/OpenAPI Documentation Guide

## Overview
Your MG-ERP application comes with **professional-grade API documentation** built into FastAPI! This document explains the comprehensive Swagger UI implementation and how to use it effectively.

## ğŸ” Available Documentation Endpoints

### **Interactive Documentation**
- **Swagger UI**: `http://127.0.0.1:8000/docs` - Primary interactive documentation
- **ReDoc**: `http://127.0.0.1:8000/redoc` - Alternative clean documentation view
- **OpenAPI Schema**: `http://127.0.0.1:8000/openapi.json` - Raw OpenAPI 3.0 specification

## ğŸ¯ What We Implemented

### **1. Enhanced Application Metadata**
```python
app = FastAPI(
    title="MG-ERP Ledger API",
    description="""
    ## ğŸ“Š Comprehensive Ledger Management System
    
    A professional-grade ERP system for managing accounts and financial transactions 
    with enterprise-level security.
    
    ### ğŸ” Authentication Required
    Most endpoints require authentication. Use the login endpoint to obtain a JWT token.
    
    ### ğŸ›ï¸ Key Features
    * Account Management - Create, view, update, and manage chart of accounts
    * Transaction Processing - Record and track financial transactions
    * User Management - Role-based access control with granular permissions
    * JWT Authentication - Secure token-based authentication system
    * Role-Based Authorization - Admin, Manager, Accountant, and Viewer roles
    
    ### ğŸš€ Quick Start
    1. Login: Use `/api/v1/auth/login` with default admin credentials (admin/admin123)
    2. Get Token: Copy the access_token from the response
    3. Authorize: Click the ğŸ”’ Authorize button and paste your token
    4. Explore: Try the account and transaction endpoints
    """,
    version="1.0.0",
    contact={
        "name": "MG-ERP Development Team",
        "url": "https://mgledger.com/contact",
        "email": "support@mgledger.com",
    },
    license_info={
        "name": "MIT License",
        "url": "https://opensource.org/licenses/MIT",
    }
)
```

### **2. Organized API Tags**
We created logical groupings for better navigation:

```python
openapi_tags=[
    {
        "name": "Authentication",
        "description": "User authentication and authorization endpoints. **Start here** to get your access token.",
    },
    {
        "name": "accounts", 
        "description": "Chart of accounts management. Create and manage your account structure for double-entry bookkeeping."
    },
    {
        "name": "transactions",
        "description": "Financial transaction recording. Post journal entries with automatic balance validation."
    },
    {
        "name": "health",
        "description": "System health and status monitoring endpoints."
    }
]
```

### **3. Enhanced Endpoint Documentation**

#### **Authentication Endpoints**
```python
@router.post("/login", 
            response_model=TokenResponse, 
            summary="ğŸ” User Login", 
            description="""
            Authenticate user and receive JWT access token.
            
            **Default admin credentials:**
            - Username: `admin`
            - Password: `admin123`
            
            The returned access token should be used in the Authorization header:
            `Authorization: Bearer <access_token>`
            """)
```

#### **Account Management Endpoints**
```python
@router.get("/", 
           response_model=List[AccountSchema], 
           summary="ğŸ“‹ List All Accounts",
           description="""
           Retrieve all accounts in the chart of accounts.
           
           **Permission Required:** `account:read`
           
           Returns the complete chart of accounts including:
           - Account codes and names
           - Account types (asset, liability, equity, revenue, expense)
           - Current balances
           - Active status
           """)
```

#### **Transaction Processing Endpoints**
```python
@router.post("/", 
            response_model=TransactionSchema,
            summary="ğŸ’° Create New Transaction",
            description="""
            Record a new financial transaction with journal entries.
            
            **Permission Required:** `transaction:create`
            
            **Double-Entry Bookkeeping Rules:**
            - Total debits must equal total credits
            - Each transaction must have at least 2 journal lines
            - Account names must exist in the chart of accounts
            
            **Transaction Sources:**
            - `manual` - Manually entered transactions
            - `import` - Imported from external systems
            - `system` - Auto-generated by system processes
            """)
```

### **4. Rich Schema Examples**

#### **Account Creation Example**
```json
{
  "name": "Cash in Bank",
  "type": "asset",
  "code": "1001",
  "description": "Main checking account for operations",
  "is_active": true
}
```

#### **User Registration Example**
```json
{
  "username": "john_doe",
  "email": "john@company.com",
  "full_name": "John Doe",
  "password": "secure_password123",
  "role": "accountant"
}
```

#### **Transaction Example**
```json
{
  "description": "Office rent payment for January 2025",
  "source": "manual",
  "reference": "CHK-001234",
  "lines": [
    {
      "account_name": "Rent Expense",
      "type": "debit",
      "amount": 2000.00
    },
    {
      "account_name": "Cash in Bank",
      "type": "credit",
      "amount": 2000.00
    }
  ]
}
```

### **5. Comprehensive Health Check**
```python
@app.get("/health", 
         summary="ğŸ” Detailed Health Check",
         description="Comprehensive health check with system information and available endpoints.")
def detailed_health_check():
    return {
        "status": "healthy",
        "service": "MG-ERP Ledger API",
        "version": "1.0.0",
        "database": "PostgreSQL",
        "authentication": "JWT Bearer Token",
        "documentation": {
            "swagger_ui": "/docs",
            "redoc": "/redoc",
            "openapi_schema": "/openapi.json"
        },
        "endpoints": {
            "authentication": "/api/v1/auth",
            "accounts": "/api/v1/accounts",
            "transactions": "/api/v1/transactions"
        },
        "default_credentials": {
            "username": "admin",
            "password": "admin123",
            "note": "âš ï¸ Change in production!"
        }
    }
```

## ğŸš€ How to Use the Swagger UI

### **Step 1: Start the Server**
```bash
uvicorn app.main:app --reload --host 127.0.0.1 --port 8000
```

### **Step 2: Open Swagger UI**
Navigate to: `http://127.0.0.1:8000/docs`

### **Step 3: Authenticate**
1. **Login**: Click on `/api/v1/auth/login` endpoint
2. **Try it out**: Click the "Try it out" button
3. **Enter credentials**:
   ```json
   {
     "username": "admin",
     "password": "admin123"
   }
   ```
4. **Execute**: Click "Execute" to get your JWT token
5. **Copy token**: Copy the `access_token` from the response

### **Step 4: Authorize**
1. **Click ğŸ”’ Authorize** button at the top of the page
2. **Enter token**: Paste your JWT token in the "Value" field
3. **Authorize**: Click "Authorize" button
4. **Close**: Close the authorization dialog

### **Step 5: Test Endpoints**
Now you can test all protected endpoints:
- âœ… **GET /api/v1/accounts** - List all accounts
- âœ… **POST /api/v1/accounts** - Create new accounts
- âœ… **GET /api/v1/transactions** - View transactions
- âœ… **POST /api/v1/transactions** - Record new transactions

## ğŸ¨ Advanced Features Available

### **Built-in FastAPI Features**
- âœ… **Interactive Testing** - Execute requests directly from docs
- âœ… **Request/Response Validation** - Live schema validation  
- âœ… **Code Generation** - Client SDK generation for multiple languages
- âœ… **Export Options** - Download OpenAPI spec as JSON/YAML
- âœ… **Multiple Themes** - Swagger UI and ReDoc interfaces
- âœ… **Mobile Responsive** - Works on all devices

### **Authentication Integration**
- âœ… **JWT Token Support** - Built-in authorization testing
- âœ… **Permission Documentation** - Required permissions clearly stated
- âœ… **Role Information** - Role-based access control explained
- âœ… **Security Schemes** - OAuth2 Bearer token authentication

### **Business Logic Documentation**
- âœ… **Double-Entry Rules** - Accounting principles explained
- âœ… **Validation Requirements** - Business rules documented
- âœ… **Error Responses** - HTTP status codes and error messages
- âœ… **Permission Matrix** - Role-based access clearly defined

## ğŸ”§ Optional Enhancements

### **Additional Features You Can Add**

#### **1. API Versioning**
```python
app_v1 = FastAPI(title="MG-ERP API v1")
app_v2 = FastAPI(title="MG-ERP API v2")
```

#### **2. Custom Themes**
```python
app = FastAPI(
    swagger_ui_parameters={
        "theme": "flattop",
        "displayRequestDuration": True,
        "docExpansion": "none",
    }
)
```

#### **3. Request Examples**
```python
@router.post("/accounts", 
            responses={
                201: {"description": "Account created successfully"},
                400: {"description": "Invalid account data"},
                403: {"description": "Insufficient permissions"},
                409: {"description": "Account code already exists"}
            })
```

#### **4. Postman Collection Export**
The OpenAPI schema can be imported directly into Postman for collection generation.

## ğŸ“Š Documentation Structure

```
MG-ERP API Documentation
â”œâ”€â”€ ğŸ” Authentication
â”‚   â”œâ”€â”€ POST /auth/login (User Login)
â”‚   â”œâ”€â”€ GET /auth/me (Current User Profile)
â”‚   â”œâ”€â”€ POST /auth/register (Create User - Admin)
â”‚   â”œâ”€â”€ POST /auth/change-password (Change Password)
â”‚   â””â”€â”€ GET /auth/users (List Users - Admin)
â”‚
â”œâ”€â”€ ğŸ“‹ Accounts  
â”‚   â”œâ”€â”€ GET /accounts (List All Accounts)
â”‚   â””â”€â”€ POST /accounts (Create New Account)
â”‚
â”œâ”€â”€ ğŸ’° Transactions
â”‚   â”œâ”€â”€ GET /transactions (List All Transactions) 
â”‚   â”œâ”€â”€ POST /transactions (Create New Transaction)
â”‚   â””â”€â”€ GET /transactions/{id} (Get Transaction by ID)
â”‚
â””â”€â”€ ğŸ¥ Health
    â”œâ”€â”€ GET / (Basic Health Check)
    â””â”€â”€ GET /health (Detailed Health Check)
```

## ğŸ¯ Business Benefits

### **For Developers**
- âœ… **Faster Integration** - Clear API documentation
- âœ… **Interactive Testing** - No need for separate testing tools
- âœ… **Code Examples** - Copy-paste ready request examples
- âœ… **Type Safety** - Complete schema definitions

### **For Business Users**
- âœ… **API Understanding** - Non-technical stakeholders can explore APIs
- âœ… **Feature Discovery** - Complete feature overview
- âœ… **Integration Planning** - Clear endpoint capabilities
- âœ… **Security Transparency** - Permission requirements visible

### **For System Integration**
- âœ… **Client Generation** - Auto-generate SDKs for multiple languages
- âœ… **API Contract** - OpenAPI spec serves as integration contract  
- âœ… **Testing Automation** - Schema validation for automated tests
- âœ… **Documentation Sync** - Always up-to-date with code changes

## ğŸ”’ Security Documentation

### **Authentication Flow**
1. **Login** â†’ JWT Token
2. **Authorization Header** â†’ `Bearer <token>`
3. **Permission Check** â†’ Role-based validation
4. **Access Control** â†’ Granular permissions

### **Role Permissions Matrix**

| Endpoint | Admin | Manager | Accountant | Viewer |
|----------|-------|---------|------------|--------|
| Login | âœ… | âœ… | âœ… | âœ… |
| List Accounts | âœ… | âœ… | âœ… | âœ… |
| Create Accounts | âœ… | âœ… | âœ… | âŒ |
| List Transactions | âœ… | âœ… | âœ… | âœ… |
| Create Transactions | âœ… | âœ… | âœ… | âŒ |
| User Management | âœ… | âŒ | âŒ | âŒ |

## ğŸ‰ Conclusion

Your MG-ERP system now has **enterprise-grade API documentation** that:

- âœ… **Rivals major SaaS platforms** in documentation quality
- âœ… **Provides interactive testing** capabilities
- âœ… **Explains business logic** clearly
- âœ… **Documents security requirements** transparently  
- âœ… **Includes practical examples** for all endpoints
- âœ… **Supports multiple export formats**
- âœ… **Works on all devices** with responsive design

**The enhanced Swagger UI makes your MG-ERP system professional, accessible, and developer-friendly!** ğŸš€

---

*Generated automatically by FastAPI with custom enhancements for MG-ERP system.*
*Last updated: September 28, 2025*